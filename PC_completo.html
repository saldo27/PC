<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro PC - Parada Cardiaca</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        h2 {
            background-color: #34495e;
            color: white;
            padding: 12px 15px;
            margin-top: 25px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-size: 16px;
            border-left: 4px solid #e74c3c;
        }
        
        h3 {
            background-color: #ecf0f1;
            color: #2c3e50;
            padding: 8px 12px;
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 14px;
            border-left: 3px solid #3498db;
        }
        
        .form-section {
            margin-bottom: 20px;
        }
        
        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 10px 0;
        }
        
        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-item input[type="checkbox"],
        .radio-item input[type="radio"] {
            cursor: pointer;
            width: 16px;
            height: 16px;
        }
        
        .checkbox-item label,
        .radio-item label {
            cursor: pointer;
            font-size: 14px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .form-field {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
            color: #2c3e50;
        }
        
        input[type="text"], 
        input[type="date"], 
        input[type="time"],
        input[type="number"],
        select,
        textarea {
            padding: 8px 10px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 13px;
            font-family: Arial, sans-serif;
        }
        
        input[type="text"]:focus,
        input[type="date"]:focus,
        input[type="time"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        
        textarea {
            resize: vertical;
            min-height: 60px;
        }
        
        .button-group {
            margin-top: 30px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        button {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 15px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #229954;
        }
        
        button.secondary {
            background-color: #95a5a6;
        }
        
        button.secondary:hover {
            background-color: #7f8c8d;
        }
        
        .time-input-group {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        .time-input-group input[type="time"] {
            flex: 0 0 120px;
        }
        
        .time-input-group input[type="date"] {
            flex: 1;
            min-width: 150px;
        }
        
        .inline-inputs {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .inline-inputs .form-field {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>REGISTRO PC</h1>
        <p class="subtitle">Parada Cardiaca - Formulario de Registro Clínico</p>
        
        <form id="pcrForm">
            <!-- DATOS IDENTIFICATIVOS -->
            <h2>Datos Identificativos</h2>
            <div class="input-group">
                <div class="form-field">
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" name="nombre">
                </div>
                <div class="form-field">
                    <label for="edad">Edad:</label>
                    <input type="number" id="edad" name="edad" min="0" max="150">
                </div>
                <div class="form-field">
                    <label for="nhc">NHC:</label>
                    <input type="text" id="nhc" name="nhc">
                </div>
                <div class="form-field">
                    <label for="nide">Nº Identificación:</label>
                    <input type="text" id="nide" name="nide">
                </div>
            </div>
            
            <div class="input-group">
                <div class="form-field">
                    <label>Sexo:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="sexoM" name="sexo" value="Masculino">
                            <label for="sexoM">Masculino</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="sexoF" name="sexo" value="Femenino">
                            <label for="sexoF">Femenino</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="sexoD" name="sexo" value="Desconocido">
                            <label for="sexoD">Desconocido</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- FACTORES DE RIESGO CARDIOVASCULAR -->
            <h2>Factores de Riesgo Cardiovascular</h2>
            
            <h3>Antecedentes Personales</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="fumador" name="fumador">
                    <label for="fumador">Fumador</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="exfumador" name="exfumador">
                    <label for="exfumador">ExFumador</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diabetes" name="diabetes">
                    <label for="diabetes">Diabetes</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="hta" name="hta">
                    <label for="hta">HTA</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="dislipemia" name="dislipemia">
                    <label for="dislipemia">Dislipemia</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="obesidad" name="obesidad">
                    <label for="obesidad">Obesidad</label>
                </div>
            </div>
            
            <h3>Antecedentes Personales</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="iam" name="iam">
                    <label for="iam">IAM</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="icc" name="icc">
                    <label for="icc">ICC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="acv" name="acv">
                    <label for="acv">ACV Previo</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="epoc" name="epoc">
                    <label for="epoc">EPOC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ircronica" name="ircronica">
                    <label for="ircronica">I. Renal Crónica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ap" name="ap">
                    <label for="ap">Arteriopatía Periférica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="marcapasos" name="marcapasos">
                    <label for="marcapasos">Marcapasos</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="dai" name="dai">
                    <label for="dai">DAI</label>
                </div>
            </div>
            
            <div class="input-group">
                <div class="form-field">
                    <label for="otrosAntecedentes">Otros Antecedentes Personales:</label>
                    <textarea id="otrosAntecedentes" name="otrosAntecedentes"></textarea>
                </div>
            </div>
            
                        
            <!-- DATOS DE LA PC Y ATENCIÓN INICIAL -->
            <h2>Datos de la PC y Atención Inicial</h2>
            
            <h3>Lugar y Contexto de la Parada</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Lugar de la Parada:</label>
                    <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarUrgencias" name="lugarPCR" value="Urgencias">
                            <label for="lugarUrgencias">Urgencias</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarHemodinámica" name="lugarPCR" value="Hemodinámica">
                            <label for="lugarHemodinámica">Hemodinámica</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarUCI" name="lugarPCR" value="UCI">
                            <label for="lugarUCI">UCI</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarPlantaMedica" name="lugarPCR" value="Planta Médica">
                            <label for="lugarPlantaMedica">Planta Médica</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarPlantaQuirurgica" name="lugarPCR" value="Planta Quirúrgica">
                            <label for="lugarPlantaQuirurgica">Planta Quirúrgica</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarQuirofano" name="lugarPCR" value="Quirófano">
                            <label for="lugarQuirofano">Quirófano</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarConsultas" name="lugarPCR" value="Consultas">
                            <label for="lugarConsultas">Consultas</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarExtrahospitalaria" name="lugarPCR" value="Extrahospitalaria">
                            <label for="lugarExtrahospitalaria">Extrahospitalaria</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lugarOtros" name="lugarPCR" value="Otros">
                            <label for="lugarOtros">Otros</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3>Presencialidad de la PC</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Testigo PCR:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="testigoPresenciada" name="testigoPCR" value="Presenciada">
                            <label for="testigoPresenciada">Presenciada</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="testigoNoPresenciada" name="testigoPCR" value="No presenciada">
                            <label for="testigoNoPresenciada">No presenciada</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3>Tipo de Testigo</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="testigoFamiliar" name="tipoTestigo" value="Familiar/No sanitario">
                    <label for="testigoFamiliar">Familiar/No sanitario</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="testigoMedico" name="tipoTestigo" value="Médico">
                    <label for="testigoMedico">Médico</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="testigoEnfermeria" name="tipoTestigo" value="Enfermería">
                    <label for="testigoEnfermeria">Enfermería</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="testigo061" name="tipoTestigo" value="061">
                    <label for="testigo061">061</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="testigoOtros" name="tipoTestigo" value="Otros">
                    <label for="testigoOtros">Otros</label>
                </div>
            </div>
            
            <h3>Tiempos Críticos</h3>
            <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 10px;">
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label for="horaParada">Hora de Parada*:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaParada" name="horaParada">
                        <input type="date" id="fechaParada" name="fechaParada">
                    </div>
                </div>
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label for="horaTiempoActivacion">Tiempo Activación Código:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaTiempoActivacion" name="horaTiempoActivacion">
                        <input type="date" id="fechaTiempoActivacion" name="fechaTiempoActivacion">
                    </div>
                </div>
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label for="horaAnalisisRitmo">Hora Análisis Ritmo:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaAnalisisRitmo" name="horaAnalisisRitmo">
                        <input type="date" id="fechaAnalisisRitmo" name="fechaAnalisisRitmo">
                    </div>
                </div>
            </div>
            
            <h3>Soporte Vital Básico (SVB)</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>¿SVB?:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="svbSi" name="svb" value="Sí">
                            <label for="svbSi">Sí</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="svbNo" name="svb" value="No">
                            <label for="svbNo">No</label>
                        </div>
                    </div>
                </div>
                <div class="form-field">
                    <label for="duracionSVB">Duración (minutos):</label>
                    <input type="number" id="duracionSVB" name="duracionSVB" min="0">
                </div>
                <div class="form-field">
                    <label for="calidadSVB">Calidad:</label>
                    <select id="calidadSVB" name="calidadSVB">
                        <option value="">Seleccionar...</option>
                        <option value="Buena">Buena</option>
                        <option value="Regular">Regular</option>
                        <option value="Mala">Mala</option>
                    </select>
                </div>
            </div>
            
            <!-- RITMO CARDÍACO INICIAL -->
            <h2>Ritmo Cardíaco Inicial</h2>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="ritmoFV" name="ritmoInicial" value="FV/TVSP">
                    <label for="ritmoFV">FV/TVSP</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ritmoAsistolia" name="ritmoInicial" value="Asistolia">
                    <label for="ritmoAsistolia">Asistolia</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ritmoAESP" name="ritmoInicial" value="AESP">
                    <label for="ritmoAESP">AESP</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="rimoBradicardia" name="ritmoInicial" value="Bradicardia Extrema">
                    <label for="rimoBradicardia">Bradicardia Extrema</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ritmoDesconocido" name="ritmoInicial" value="Desconocido">
                    <label for="ritmoDesconocido">Desconocido</label>
                </div>
            </div>
            
            <!-- ETIOLOGÍA PC -->
            <h2>Etiología PC</h2>
            <div class="checkbox-group" style="flex-direction: column; gap: 10px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaCardiaca" name="etiologiaPCR" value="Cardíaca">
                    <label for="etiologiaCardiaca">Cardíaca</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaRespiratoria" name="etiologiaPCR" value="Respiratoria">
                    <label for="etiologiaRespiratoria">Respiratoria</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaNeurologia" name="etiologiaPCR" value="Neurológica">
                    <label for="etiologiaNeurologia">Neurológica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaTraumatologia" name="etiologiaPCR" value="Traumatológica">
                    <label for="etiologiaTraumatologia">Traumatológica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaFarmacologica" name="etiologiaPCR" value="Farmacológica">
                    <label for="etiologiaFarmacologica">Farmacológica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaAhogamiento" name="etiologiaPCR" value="Ahogamiento">
                    <label for="etiologiaAhogamiento">Ahogamiento</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaOtros" name="etiologiaPCR" value="Otros">
                    <label for="etiologiaOtros">Otros</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="etiologiaDesconocida" name="etiologiaPCR" value="Desconocida">
                    <label for="etiologiaDesconocida">Desconocida</label>
                </div>
            </div>
            
            <!-- SOPORTE VITAL AVANZADO -->
            <h2>Soporte Vital Avanzado (SVA)</h2>
            
            <h3>Datos del Equipo SVA</h3>
            <h3>Operador</h3>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorUCI" name="operador" value="UCI">
                    <label for="operadorUCI">UCI</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorUrgencias" name="operador" value="Urgencias">
                    <label for="operadorUrgencias">Urgencias</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorInternista" name="operador" value="Internista">
                    <label for="operadorInternista">Internista</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorCardiologo" name="operador" value="Cardiólogo">
                    <label for="operadorCardiologo">Cardiólogo</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorAnestesista" name="operador" value="Anestesista">
                    <label for="operadorAnestesista">Anestesista</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operador061" name="operador" value="061">
                    <label for="operador061">061</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="operadorOtro" name="operador" value="Otro">
                    <label for="operadorOtro">Otro</label>
                </div>
            </div>
            
            <h3>¿Realización SVA?</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="realizacionSi" name="realizacionSVA" value="Sí">
                    <label for="realizacionSi">Sí</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="realizacionResuelta" name="realizacionSVA" value="Resuelta">
                    <label for="realizacionResuelta">Resuelta</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="realizacionFutil" name="realizacionSVA" value="Futil">
                    <label for="realizacionFutil">Futil</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="realizacionONR" name="realizacionSVA" value="ONR">
                    <label for="realizacionONR">ONR</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="realizacionFalsaPCR" name="realizacionSVA" value="Falsa PCR">
                    <label for="realizacionFalsaPCR">Falsa PCR</label>
                </div>
            </div>
            
            <div id="svaFieldsContainer" style="display: none;">
                <h3>Tiempos Críticos del SVA</h3>
            <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 10px;">
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label>Hora llegada 1er equipo:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaLlegada1er" name="horaLlegada1er">
                        <input type="date" id="fechaLlegada1er" name="fechaLlegada1er">
                    </div>
                </div>
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label>Hora llegada 2º equipo:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaLlegada2o" name="horaLlegada2o">
                        <input type="date" id="fechaLlegada2o" name="fechaLlegada2o">
                    </div>
                </div>
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label>Comienzo SVA:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaComienzSVA" name="horaComienzSVA">
                        <input type="date" id="fechaComienzSVA" name="fechaComienzSVA">
                    </div>
                </div>
                <div class="form-field" style="flex: 1; min-width: 250px;">
                    <label>Fin SVA:</label>
                    <div class="time-input-group">
                        <input type="time" id="horaFinSVA" name="horaFinSVA">
                        <input type="date" id="fechaFinSVA" name="fechaFinSVA">
                    </div>
                </div>
            </div>
            
            <h3>Desfibrilación</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Desfibrilación:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="desfibNo" name="desfibrilacion" value="No">
                            <label for="desfibNo">No</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="desfibDESA" name="desfibrilacion" value="DESA/Choque">
                            <label for="desfibDESA">DESA/Choque</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="desfibDESANoChoque" name="desfibrilacion" value="DESA/No choque">
                            <label for="desfibDESANoChoque">DESA/No choque</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="desfibManual" name="desfibrilacion" value="Manual">
                            <label for="desfibManual">Manual</label>
                        </div>
                    </div>
                </div>
                <div class="form-field">
                    <label for="numDescargas">Nº Descargas:</label>
                    <input type="number" id="numDescargas" name="numDescargas" min="0">
                </div>
            </div>
            
            <h3>Aislamiento de Vía Aérea</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Aislamiento Vía Aérea:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="viaNo" name="viaAerea" value="No">
                            <label for="viaNo">No</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="viaYaAislada" name="viaAerea" value="Ya aislada">
                            <label for="viaYaAislada">Ya aislada</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="viaIOT" name="viaAerea" value="IOT">
                            <label for="viaIOT">IOT</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="viaCrico" name="viaAerea" value="Crico/Traqueo">
                            <label for="viaCrico">Crico/Traqueo</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="viaOtroDispositivo" name="viaAerea" value="Otro dispositivo">
                            <label for="viaOtroDispositivo">Otro dispositivo</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3>Fármacos Administrados</h3>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="farmacoAdrenalina" name="farmacos" value="Adrenalina">
                    <label for="farmacoAdrenalina">Adrenalina <input type="number" id="ciclosAdrenalina" name="ciclosAdrenalina" style="width: 60px; margin-left: 10px;" placeholder="Ciclos"></label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="farmacoAmiodarona" name="farmacos" value="Amiodarona">
                    <label for="farmacoAmiodarona">Amiodarona</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="farmacoAtropina" name="farmacos" value="Atropina">
                    <label for="farmacoAtropina">Atropina</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="farmacoBicarbonato" name="farmacos" value="Bicarbonato">
                    <label for="farmacoBicarbonato">Bicarbonato</label>
                </div>
            </div>
            
            <h3>Dispositivos Avanzados</h3>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="dispCardiocompresor" name="dispositivos" value="Cardiocompresor">
                    <label for="dispCardiocompresor">Cardiocompresor</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="dispMarcapasos" name="dispositivos" value="Marcapasos">
                    <label for="dispMarcapasos">Marcapasos</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="dispCVC" name="dispositivos" value="CVC">
                    <label for="dispCVC">CVC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="dispDrenaje" name="dispositivos" value="Drenaje">
                    <label for="dispDrenaje">Drenaje</label>
                </div>
            </div>
            
            <h3>Duración de Maniobras</h3>
            <div class="input-group">
                <div class="form-field">
                    <label for="duracionManiobras">Duración Aproximada (minutos):</label>
                    <input type="number" id="duracionManiobras" name="duracionManiobras" min="0">
                </div>
            </div>
            
            <!-- RECUPERACIÓN Y RESULTADO -->
            <h2>Recuperación y Destino</h2>
            
            <h3>Resultado de la Reanimación</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Recuperación/ROSC:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="roscNo" name="rosc" value="No">
                            <label for="roscNo">No</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="roscSiTransitoria" name="rosc" value="Sí/Transitoria">
                            <label for="roscSiTransitoria">Sí/Transitoria</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="roscSiDefinitiva" name="rosc" value="Sí/Definitiva">
                            <label for="roscSiDefinitiva">Sí/Definitiva</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3>Destino del Paciente</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoUCI" name="destino" value="UCI">
                    <label for="destinoUCI">UCI</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoUrgencias" name="destino" value="Urgencias">
                    <label for="destinoUrgencias">Urgencias</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoQuirofano" name="destino" value="Quirófano">
                    <label for="destinoQuirofano">Quirófano</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoPlanta" name="destino" value="Planta">
                    <label for="destinoPlanta">Planta</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoOtroHospital" name="destino" value="Otro Hospital">
                    <label for="destinoOtroHospital">Otro Hospital</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="destinoExitus" name="destino" value="Exitus">
                    <label for="destinoExitus">Exitus</label>
                </div>
            </div>
            
            <h3>Técnicas Especiales</h3>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnicaFibrinolisis" name="tecnicas" value="Fibrinolisis">
                    <label for="tecnicaFibrinolisis">Fibrinolisis</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnicaICP" name="tecnicas" value="ICP">
                    <label for="tecnicaICP">ICP</label>
                </div>
                <div style="display: flex; gap: 15px; align-items: flex-end; margin: 8px 0;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="tecnicaControlTa" name="tecnicas" value="Control de Tª">
                        <label for="tecnicaControlTa">Control de Tª</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="tecnicaTaObjetivo" style="margin: 0; font-weight: bold; font-size: 14px;">Objetivo:</label>
                        <input type="number" id="tecnicaTaObjetivo" name="taObjetivo" placeholder="°C" style="width: 80px; padding: 8px 10px; border: 1px solid #bdc3c7; border-radius: 4px; font-size: 13px;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="tecnicaDuracionTa" style="margin: 0; font-weight: bold; font-size: 14px;">Duración:</label>
                        <input type="number" id="tecnicaDuracionTa" name="duracionTa" placeholder="horas" style="width: 80px; padding: 8px 10px; border: 1px solid #bdc3c7; border-radius: 4px; font-size: 13px;">
                    </div>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnicaQuirofano" name="tecnicas" value="Quirófano">
                    <label for="tecnicaQuirofano">Quirófano</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnicaNinguno" name="tecnicas" value="Ninguno">
                    <label for="tecnicaNinguno">Ninguno</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnicaOtros" name="tecnicas" value="Otros">
                    <label for="tecnicaOtros">Otros</label>
                </div>
            </div>
            
            <!-- HOSPITALIZACIÓN Y SEGUIMIENTO -->
            <h2>Hospitalización y Seguimiento</h2>
            
            <h3>Estancia Hospitalaria</h3>
            <div class="input-group">
                <div class="form-field">
                    <label for="estanciaUCI">Estancia UCI (días):</label>
                    <input type="number" id="estanciaUCI" name="estanciaUCI" min="0">
                </div>
                <div class="form-field">
                    <label for="fechaAlta">Fecha Alta Hospitalaria:</label>
                    <input type="date" id="fechaAlta" name="fechaAlta">
                </div>
            </div>
            
            <h3>Función Cerebral y Estado</h3>
            <div class="input-group">
                <div class="form-field">
                    <label>Función Cerebral/Estado:</label>
                    <div class="radio-group" style="flex-direction: column; gap: 8px;">
                        <div class="radio-item">
                            <input type="radio" id="cerebroBueno" name="funcionCerebral" value="Buen estado">
                            <label for="cerebroBueno">Buen estado</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroModera" name="funcionCerebral" value="Incapacidad moderada">
                            <label for="cerebroModera">Incapacidad moderada</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroSevera" name="funcionCerebral" value="Incapacidad severa">
                            <label for="cerebroSevera">Incapacidad severa</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroVegetativo" name="funcionCerebral" value="Vegetativo">
                            <label for="cerebroVegetativo">Vegetativo</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroMuerto" name="funcionCerebral" value="Muerto">
                            <label for="cerebroMuerto">Muerto</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroOtros" name="funcionCerebral" value="Otros">
                            <label for="cerebroOtros">Otros</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="cerebroDesconocido" name="funcionCerebral" value="Desconocido">
                            <label for="cerebroDesconocido">Desconocido</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- CAUSA DE EXITUS -->
            <div id="causaExitusSectionContainer" style="display: none;">
                <h2>Causa de Exitus</h2>
                <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaCardio" name="causaExitus" value="Cardio">
                        <label for="causaCardio">Cardio</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaTrauma" name="causaExitus" value="Trauma">
                        <label for="causaTrauma">Trauma</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaCancer" name="causaExitus" value="Cáncer">
                        <label for="causaCancer">Cáncer</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaNeuro" name="causaExitus" value="Neuro">
                        <label for="causaNeuro">Neuro</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaOtras" name="causaExitus" value="Otras">
                        <label for="causaOtras">Otras</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="causaDesconocida" name="causaExitus" value="Desconocida">
                        <label for="causaDesconocida">Desconocida</label>
                    </div>
                </div>
            </div>
            
            <!-- DIAGNÓSTICO -->
            <h2>Diagnóstico</h2>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <div class="checkbox-item">
                    <input type="checkbox" id="diagIAM" name="diagnostico" value="IAM">
                    <label for="diagIAM">IAM</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagTEP" name="diagnostico" value="TEP">
                    <label for="diagTEP">TEP</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagTaponamiento" name="diagnostico" value="Taponamiento">
                    <label for="diagTaponamiento">Taponamiento</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagObstruccion" name="diagnostico" value="Obstrucción vía aérea">
                    <label for="diagObstruccion">Obstrucción vía aérea</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagInsufRespira" name="diagnostico" value="Insuf. respiratoria">
                    <label for="diagInsufRespira">Insuf. respiratoria</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagToxico" name="diagnostico" value="Tóxico/Metabólica">
                    <label for="diagToxico">Tóxico/Metabólica</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagACV" name="diagnostico" value="ACV">
                    <label for="diagACV">ACV</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagTCE" name="diagnostico" value="TCE">
                    <label for="diagTCE">TCE</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagPolitrauma" name="diagnostico" value="Politrauma/Shock hemorrágico">
                    <label for="diagPolitrauma">Politrauma/Shock hemorrágico</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="diagOtros" name="diagnostico" value="Otros">
                    <label for="diagOtros">Otros</label>
                </div>
            </div>
            
            <div class="input-group">
                <div class="form-field">
                    <label for="observaciones">Observaciones Generales:</label>
                    <textarea id="observaciones" name="observaciones"></textarea>
                </div>
            </div>
            </div>
            
            <!-- BOTONES -->
            <div class="button-group">
                <button type="reset" class="secondary">Limpiar Formulario</button>
                <button type="button" onclick="downloadXLSX()">Descargar como XLSX</button>
                <button type="button" onclick="printForm()">Imprimir</button>
            </div>
        </form>
    </div>
    
    <script>
        // Controlar visibilidad de "Causa de Exitus" según "Función Cerebral y Estado"
        function toggleCausaExitus() {
            const funcionCerebral = document.querySelector('input[name="funcionCerebral"]:checked');
            const causaExitusSection = document.getElementById('causaExitusSectionContainer');
            
            if (funcionCerebral && funcionCerebral.value === 'Muerto') {
                causaExitusSection.style.display = 'block';
            } else {
                causaExitusSection.style.display = 'none';
            }
        }
        
        // Agregar event listeners a los radios de "Función Cerebral y Estado"
        document.addEventListener('DOMContentLoaded', function() {
            const funcionCerebralRadios = document.querySelectorAll('input[name="funcionCerebral"]');
            funcionCerebralRadios.forEach(radio => {
                radio.addEventListener('change', toggleCausaExitus);
            });
        });
        
        // Controlar visibilidad de campos cuando se selecciona "Sí" en "Realización SVA"
        function toggleSvaFields() {
            const realizacionCheckboxes = document.querySelectorAll('input[name="realizacionSVA"]');
            const svaFieldsContainer = document.getElementById('svaFieldsContainer');
            let isSiChecked = false;
            
            realizacionCheckboxes.forEach(checkbox => {
                if (checkbox.checked && checkbox.value === 'Sí') {
                    isSiChecked = true;
                }
            });
            
            if (isSiChecked) {
                svaFieldsContainer.style.display = 'block';
            } else {
                svaFieldsContainer.style.display = 'none';
            }
        }
        
        // Agregar event listeners a los checkboxes de "Realización SVA"
        document.addEventListener('DOMContentLoaded', function() {
            const realizacionCheckboxes = document.querySelectorAll('input[name="realizacionSVA"]');
            realizacionCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', toggleSvaFields);
            });
        });
        
        function downloadXLSX() {
            try {
                const form = document.getElementById('pcrForm');
                if (!form) {
                    alert('Error: No se encontró el formulario');
                    return;
                }
                
                let dataArray = [];
                let headerRow = [];
                let valueRow = [];
                let processedNames = new Set();
                
                // Recopilar datos del formulario
                for (let i = 0; i < form.elements.length; i++) {
                    const element = form.elements[i];
                    if (element.name && element.type !== 'button' && !processedNames.has(element.name)) {
                        processedNames.add(element.name);
                        headerRow.push(element.name);
                        
                        let value = '';
                        
                        // Obtener valores seleccionados
                        const elements = form.querySelectorAll(`[name="${element.name}"]`);
                        let values = [];
                        
                        elements.forEach(el => {
                            if (el.type === 'checkbox' && el.checked) {
                                values.push(el.value);
                            } else if (el.type === 'radio' && el.checked) {
                                values.push(el.value);
                            } else if (el.type !== 'checkbox' && el.type !== 'radio' && el.value) {
                                values.push(el.value);
                            }
                        });
                        
                        value = values.join('; ');
                        valueRow.push(value);
                    }
                }
                
                dataArray.push(headerRow);
                dataArray.push(valueRow);
                
                // Verificar que XLSX esté disponible
                if (typeof XLSX === 'undefined') {
                    alert('Error: La librería XLSX no está cargada. Por favor, intenta de nuevo.');
                    return;
                }
                
                // Crear workbook con los datos
                const worksheet = XLSX.utils.aoa_to_sheet(dataArray);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "Registro PC");
                
                // Ajustar ancho de columnas automáticamente
                const colWidths = headerRow.map(header => ({wch: Math.max(header.length, 15)}));
                worksheet['!cols'] = colWidths;
                
                // Descargar el archivo
                XLSX.writeFile(workbook, 'Registro_PC.xlsx');
                
                console.log('Archivo XLSX descargado exitosamente');
            } catch (error) {
                console.error('Error al descargar XLSX:', error);
                alert('Error al descargar el archivo: ' + error.message);
            }
        }
        
        function printForm() {
            window.print();
        }
    </script>
</body>
</html>
